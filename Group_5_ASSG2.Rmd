---
title: "Group 5 ASSG2"
output:
  pdf_document: default
  html_document: default
date: "`r Sys.Date()`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,error = FALSE, message = FALSE,
                      warning = FALSE,
                      out.height = "\\textheight",  out.widtibh = "\\textwidth")
```

```{r packages, include=FALSE}
library(pagedown) # For simulating PDFs before knitting
library(dplyr)
library(psych) # For describe() providing summary stats
library(quantmod) # For importing stock from Yahoo
library(ggplot2) # Visualizations
library(forecast) # Autoplot
library(tseries) # ADF test and more
library(FinTS) # ARCH LM test
```

**Importing Ford Motor Company stock statistics**

```{r importing, echo=TRUE}
#This code does it.
getSymbols('F', src = 'yahoo', from = as.Date('2022-01-01'), to = 
             as.Date('2025-03-20'))
```
**Some Ford's stock closing prices**

```{r closing prices, echo=FALSE}
F_closing <- F$F.Close
head(F_closing)
```
\newpage

**Time series plot of Ford's Closing prices**

```{r ts conversion, echo=FALSE}
F_closing_ts <- ts(F_closing, start = c(2022,1), frequency = 240)
autoplot(F_closing_ts) + ggtitle('Ford Company Stock closing prices')
```


```{r daily log returns, echo=TRUE}
#This computes the daily log returns
F_returns <- diff(log(F_closing_ts))
```

*Some daily log returns*

```{r log returns, echo=FALSE}
tail(F_returns)
```


\newpage

**PART 1: EXPLORATORY DATA ANALYSIS**

**Log-returns ts plot**

```{r returns plot, echo=FALSE}
autoplot(F_returns) + 
  ggtitle('Ford Motor Stock daily log returns')
```


**Summary statistics of the returns**

```{r summary statistics, echo=FALSE}
describe(F_returns)
```

*Ford Company's stock returns have a mean of zero and a variance of 1. This can imply stationarity since these statistics do not change over time, but further tests are needed to truly confirm this.*

-Skewness measures asymmetry. This tells us whether there are extreme values on the left or on the right.

*The negative skewness of -1 suggests the returns have a slightly longer left tail. Large losses are therefore more likely to occur.*

-Kurtosis measures the tailedness of a distribution. This shows how often extreme values occur as compared to a normal distribution (Where kurtosis = 3).

*Results show that returns have a high kurtosis (returns are leptokurtic). Losses (or gains) occur more frequently than normal. This implies higher risk involved with this stock.*

\newpage

**ADF Stationarity test**

-Null hypothesis: The Series is non-stationary

*Fail to reject if P > [level of significance]*

-Alternative hypothesis: The Series is stationary

*Reject Null in favour of the alternative if P < [level of significance]*

-The results are as shown:

```{r adf, echo=FALSE}
print(adf.test(F_returns))
```

-Assuming the default significance level of 5% (0.05), The p-value shown is less than this. We therefore reject the null hypothesis in favour of the alternative one and conclude that Ford's returns are indeed stationary.

\newpage

**Checking for ARCH effects on squared returns**

```{r ARCH effects, echo=FALSE}
ggAcf(F_returns^2) + 
  ggtitle('Autocorrelations of Ford Company squared returns')
```

-Only 7 out of 480 lags exceed the confidence interval(~1.458%). At 5% significance, 24 lags (480 * 5%) or more exceeding the confidence level would be regarded as statistically significant. We can therefore safely ignore the lags appearing above the ci as there are statistically insignificant

-The above plot therefore shows no significant autocorrelations seen from the squared returns; and therefore no volatility clustering. This means that volatility (squared returns) is homoscedastic (not heteroscedastic)... the variance, or volatility, is therefore constant.

-ARCH effects can further be tested in depth using the Lagrange Multiplier (LM) test. 

\newpage

**ARCH-LM test**

-Null hypothesis: No ARCH effects (homoscedasticity)

-Alternative hypothesis: There is ARCH effects (heteroscedasticity)

*Reject Null hypothesis if P < [level of significance]*

```{r ARCH-LM, echo=FALSE}
print(ArchTest(F_returns))
```
-The p-value (0.9881) is significantly more than 0.05. We therefore fail to reject the Null hypothesis and conclude that Ford Company's stock returns are homoscedastic; they exhibit no ARCH effects.

\newpage

**PART 2 ARCH**

**Estimating ARCH(p)**

**Estimate an ARCH(p) model with (p) determined by minimizing the AIC (p between 1 and 5).Use 
zero-mean model.**

```{r}
library(rugarch)
# Check your returns
summary(F_returns)
plot(F_returns, type = "l")

# Initialize vectors to store AIC values and models
aic_values <- numeric(5)
models <- list()

# Loop over p from 1 to 5 to find best ARCH(p)
for (p in 1:5) {
  # Define ARCH(p) spec as sGARCH(p, 0) with zero-mean
  spec <- ugarchspec(
    variance.model = list(model = "sGARCH", garchOrder = c(p, 0)),
    mean.model = list(armaOrder = c(0, 0), include.mean = FALSE),  # Zero-mean model
    distribution.model = "norm"  # Normal distribution
  )
  
  # Fit the model to returns
  fit <- ugarchfit(spec = spec, data = F_returns)
  
  # Save AIC value
  aic_values[p] <- infocriteria(fit)[1]
  
  # Save model object
  models[[p]] <- fit
  
  # Print AIC for each p
  cat("ARCH(", p, ") AIC:", aic_values[p], "\n")
}

# Find best p based on minimum AIC
best_p <- which.min(aic_values)
cat("\nBest ARCH(p): p =", best_p, "with AIC =", aic_values[best_p], "\n")

# Retrieve the best model
best_model <- models[[best_p]]

# Summary of the best model
show(best_model)

```
**Extract and plot the conditional volatility** 

```{r}
# Extract the conditional volatility (sigma)
conditional_volatility <- sigma(best_model)

# Plot the conditional volatility over time
plot(conditional_volatility, type = "l", col = "blue", lwd = 2,
     main = paste("Conditional Volatility from ARCH(", best_p, ")", sep = ""),
     xlab = "Time", ylab = "Volatility")

```

**Check the standardized residuals for autocorrelation**

```{r}
# Extract standardized residuals
std_residuals <- residuals(best_model, standardize = TRUE)

# Plot standardized residuals
plot(std_residuals, type = "l", main = "Standardized Residuals", col = "darkgreen")

# Ljung-Box test for autocorrelation in standardized residuals
Box.test(std_residuals, lag = 10, type = "Ljung-Box")

# Ljung-Box test for squared standardized residuals (tests for remaining ARCH effects)
Box.test(std_residuals^2, lag = 10, type = "Ljung-Box")

# ACF plots
par(mfrow = c(1, 2))
acf(std_residuals, main = "ACF of Std Residuals")
acf(std_residuals^2, main = "ACF of Sq Std Residuals")
par(mfrow = c(1, 1))

```
**Discussion: Why ARCH(p) May Be Insufficient for Financial Volatility**

#Captures short-term volatility clustering poorly.

ARCH models require high orders (large p) to capture persistent volatility, which can lead to overfitting and inefficient estimation.

#Volatility persistence is not well-modeled.

Financial returns show long memory in volatility. ARCH models do not allow for volatility to decay slowly over time like GARCH models do.

#Cannot model asymmetry (leverage effect).

Financial markets often exhibit asymmetric volatility (negative shocks increase volatility more than positive shocks). ARCH ignores this.

#Residual diagnostics may show remaining ARCH effects.

Even after fitting ARCH, squared standardized residuals may still show autocorrelation, indicating that the model hasn't captured all dynamics.


